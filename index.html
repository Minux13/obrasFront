<!DOCTYPE html>
<html><head>
        
        <meta charset="utf-8">

        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta http-equiv="X-UA-Compatible" content="IE=edge">

	    <!--Loading bootstrap css-->
	    <link href="./Tableros_files/jquery-ui-1.10.4.custom.min.css" rel="stylesheet" type="text/css">
	    <link href="./Tableros_files/jquery.dataTables.min.css" rel="stylesheet" type="text/css">
	    <link href="./Tableros_files/jquery-ui.css" rel="stylesheet" type="text/css">
	    <link href="./Tableros_files/buttons.dataTables.min.css" rel="stylesheet" type="text/css">	    
	    <link href="./Tableros_files/dataTables.jqueryui.min.css" rel="stylesheet" type="text/css">

	    <link href="./Tableros_files/animate.css" rel="stylesheet" type="text/css">
	    <link href="./Tableros_files/main.css" rel="stylesheet" type="text/css">
	    <link href="./Tableros_files/style-responsive.css" rel="stylesheet" type="text/css">
	    <link href="./Tableros_files/zabuto_calendar.min.css" rel="stylesheet" type="text/css">
	    <link href="./Tableros_files/pace.css" rel="stylesheet" type="text/css">
	    <link href="./Tableros_files/jquery.news-ticker.css" rel="stylesheet" type="text/css">
        
        <!-- Bootstrap CSS CDN -->
        <link href="./Tableros_files/bootstrap.min.css" rel="stylesheet" type="text/css">
        <!-- Our Custom CSS -->
        <link href="./Tableros_files/style4.css" rel="stylesheet" type="text/css">
	    
        
        <link href="./Tableros_files/obras.css" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
 
        <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet">

        <title>Tableros</title>
    <style id="holderjs-style" type="text/css"></style></head>
    <body class="  pace-done"><div class="pace  pace-inactive"><div class="pace-progress" data-progress-text="100%" data-progress="99" style="width: 100%;">
  <div class="pace-progress-inner"></div>
</div>
<div class="pace-activity"></div></div>

        <div class="wrapper">
            <!-- Sidebar Holder -->
			<nav id="sidebar" style="min-height: 100%;">
                <div class="sidebar-header">
                    <div class="sjo-logo-big">
                	    <img width="244" height="119" class="img-fluid" src="./Tableros_files/logo.png">
                    </div>
                    <div class="sjo-logo-small">
                	    <img width="244" height="119" class="img-fluid" src="./Tableros_files/escudo.png">
                    </div>
                </div>

                <ul class="list-unstyled components">
                
                    <li class="menu-element">
                        <a href="#" data-toggle="collapse">
                            <i class="fa fa-cogs fa-fw"></i>
                            <span class="menu-title">Administración</span>
                        </a>
                    </li>
                    <li class="menu-element">
                        <a id="portfolio" href="#">
                            <i class="fa fa-briefcase"></i>
                            <span class="menu-title">Portafolio</span>
                        </a>                       
                    </li>
                    <li class="menu-element"> 
                        <a href="#">
                            <i class="fa fa-sitemap fa-fw"> </i>
                            <span class="menu-title">Definición de Proyecto</span>
                        </a>
                    </li>
                    <li class="menu-element">
                        <a href="#">
                            <i class="fa fa-tasks fa-fw"> </i>
                            <span class="menu-title">Gestión de Proyecto</span>
                        </a>                          
                    </li>
                    <li class="menu-element">
                        <a href="#">
                            <i class="fa fa-table fa-fw"> </i>
                            <span class="menu-title">Reportes</span>
                        </a>                 
                    </li>
                    <li class="menu-element">
                        <a href="#">
                            <i class="fa fa-tachometer-alt fa-fw"> </i>
                            <span class="menu-title">Tablero</span>
                        </a>
                    </li>
                

                
                    
                </ul>
            </nav>



            <!-- Page Content Holder -->
            <div id="content" class="container-fluid">

			<!-- Nav Bar -->
                <nav class="navbar navbar-default navbar-static-top" >
                    <div class="container-fluid">

                        <div class="navbar-header">
                            <button class="btn btn-info navbar-btn" id="sidebarCollapse" type="button">
                                <i class="fa fa-bars"></i>
                                    <span class="sr-only">Toggle navigation</span>
                            </button>
                        </div>



                        <div class="dropdown">
                            <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <i class="fas fa-user-circle" style="font-size: 20px; vertical-align: -1px;"></i>
                                Alberto Peréz
                            </button>
                            <div class="dropdown-menu dropdown-menu-sw" aria-labelledby="dropdownMenuButton">
                              

                                <a class="dropdown-item" href="#"><i class="fa fa-user"></i>Mi Perfil</a>               
                                <a class="dropdown-item" href="#"><i class="fa fa-calendar"></i>Mi Calendario</a>
                                <a class="dropdown-item" href="#"><i class="fa fa-envelope"></i>Mi Buzón</a>     
                                <div class="dropdown-divider"></div>
                                <a class="dropdown-item" href="#"><i class="fas fa-sign-out-alt"></i></i>Salir</a>      


                            </div>
                        </div>



                        
                    </div>
                </nav>


                <!--BEGIN TITLE & BREADCRUMB PAGE-->
				
                <div class="page-title-breadcrumb" id="title-breadcrumb-option-demo">
                    <ol class="breadcrumb page-breadcrumb">
                        <li><i class="fa fa-home"></i>&nbsp;<a href="#">Administración</a>&nbsp;&nbsp;<i class="fa fa-angle-right"></i>&nbsp;&nbsp;</li>
                         
                    </ol>
                    <div class="clearfix"></div>
                </div>
                
                <!--END TITLE & BREADCRUMB PAGE-->
                

				<!-- PAGE CONTENT -->
                <!--BEGIN CONTENT-->
                <div class="container-fluid">
                	<br>
               	
                	<div class="row">
                		<div class="col-lg-12">
	                 		<div class="portlet box">
	                            <div class="portlet-header">
	                                <div class="caption">Estatus de Obras</div>
	                                <div class="tools"><i class="fa fa-chevron-up"></i><i data-toggle="modal" data-target="#modal-config" class="fa fa-cog"></i><i class="fa fa-refresh"></i><i class="fa fa-times"></i></div>
	                            </div>
	                            <div class="portlet-body">
									<div class="row">
										<div class="col-md-4 col-sm-6">
											<label for="message-text" class="col-form-label"><b>Dependencia:</b></label>
											<select id="dependency" class="form-control " required="">
												<option value="0">--Seleccione una Dependencia--</option>
												<option value="1">INFRAESTRUCTURA</option>
												<option value="2">ICIFED</option>
												<option value="3">REA</option>
												<option value="4">SADM</option>
												<option value="5">SSNL</option>
												<option value="6">CODETUR</option>
												<option value="7">CODEFRONT</option>
												<option value="8">FIDEPROES</option>
												<option value="9">DIF</option>
												<option value="10">FUNDIDORA</option>
												<option value="11">CONALEP</option>
												<option value="12">CAMINOS</option>
												<option value="13">ISSSTELEON</option>
												<option value="14">TOTAL</option>
											</select>
											<div class="invalid-feedback">Debe seleccionar una dependencia</div>
										</div>
							       	</div>
	                                <div id="genl-pie-chart" style="width: 100%; height:400px"></div>
	                            </div>
	                        </div>
                        </div>
                    </div>
                            
				</div>
                   
               	<!-- BEGIN MODAL TABLE -->
               	<div class="modal" tabindex="-1" role="dialog" id="myModalTable">
				  <div class="modal-dialog" style="max-width:80%!important;" role="document">
				    <div class="modal-content">
				      <div class="modal-header">
				        <h5 class="modal-title">Estatus de la Obra</h5>
				        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
				          <span aria-hidden="true">×</span>
				        </button>
				      </div>
				      <div class="modal-body">
				      	<div class="table-responsive">
							<table class="table table-striped table-bordered" style="margin-bottom: 0">
							  <thead class="thead-dark">
							    
									<th scope="col">No.</th>
									<th scope="col">Municipio</th>
									<th scope="col">Categoría</th>
									<th scope="col">Obra</th>
									<th scope="col">Empresa</th>
									<th scope="col">No. Contrato</th>
									<th scope="col">Monto Contratado</th>
									<th scope="col">Inicio Según Contrato</th>
									<th scope="col">Término Según Contrato</th>
									<th scope="col">Fecha Pago Anticipo</th>
									<th scope="col">Monto del Anticipo</th>
                                    <!--
									<th scope="col">Terminación Compromiso 2018</th> 
									<th scope="col">Fecha Convenio Ampliación</th>-->
									<th scope="col">Convenio Ampliación Económico</th>
									<th scope="col">Monto Contrato Final</th>
									<th scope="col">Total Pagado</th>
									<th scope="col">Anticipo Pendiente  Amortizar</th>
									<th scope="col">Avance Financiero</th>
									<th scope="col">Avance Físico Verificado</th>
									<th scope="col">Entregada al Beneficiario</th>
									<th scope="col">Fecha Verificación</th>
									<th scope="col">Estatus Verificado</th>
									<th scope="col">Registro Visita</th>
							    
							  </thead>
							  <tbody>
							  </tbody>
							</table>
						</div>
				      </div>
				      <div class="modal-footer">
				        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
				      </div>
				    </div>
				  </div>
				</div>
               	<!-- END MODAL TABLE -->
               	
                   
                <!--BEGIN FOOTER-->
                    <div id="footer">
                        <div class="copyright">
                            <a href="http://localhost:8080/dashboard#">Gobierno del Estado de Nuevo León</a>
                        </div>
                    </div>
                <!--END FOOTER-->

            
            </div>
        </div>


<!-- Include JS Libraries  -->
 
        <!-- jQuery CDN -->
		<script async="" src="./Tableros_files/analytics.js">
        </script><script src="./Tableros_files/jquery-3.3.1.min.js"></script>
		<script src="./Tableros_files/jquery-migrate-3.0.0.min.js"></script>
		<!-- Bootstrap Js CDN -->
		<script src="./Tableros_files/bootstrap.min.js"></script>
	    <script src="./Tableros_files/jquery-ui.js"></script>
	    <script src="./Tableros_files/bootstrap-hover-dropdown.js"></script>
	    <script src="./Tableros_files/html5shiv.js"></script>
	    <script src="./Tableros_files/respond.min.js"></script>
	    <script src="./Tableros_files/jquery.metisMenu.js"></script>
	    <script src="./Tableros_files/jquery.slimscroll.js"></script>
	    <script src="./Tableros_files/jquery.cookie.js"></script>
	    <script src="./Tableros_files/icheck.min.js"></script>
	    <script src="./Tableros_files/custom.min.js"></script>
	    <script src="./Tableros_files/jquery.news-ticker.js"></script>
	    <script src="./Tableros_files/jquery.menu.js"></script>
	    <script src="./Tableros_files/pace.min.js"></script>
	    <script src="./Tableros_files/holder.js"></script>
	    <script src="./Tableros_files/responsive-tabs.js"></script>
	    <script src="./Tableros_files/jquery.flot.js"></script>
	    <script src="./Tableros_files/jquery.flot.categories.js"></script>
	    <script src="./Tableros_files/jquery.flot.pie.js"></script>
	    <script src="./Tableros_files/jquery.flot.tooltip.js"></script>
	    <script src="./Tableros_files/jquery.flot.resize.js"></script>
	    <script src="./Tableros_files/jquery.flot.fillbetween.js"></script>
	    <script src="./Tableros_files/jquery.flot.stack.js"></script>
	    <script src="./Tableros_files/jquery.flot.spline.js"></script>
	    <script src="./Tableros_files/zabuto_calendar.min.js"></script>
	    <script src="./Tableros_files/index.js"></script>
        <script src="./Tableros_files/jsonpath-0.8.0.js"></script>
	    <script type="text/javascript" src="./Tableros_files/jquery.dataTables.min.js"></script>
	    <!-- 
	    <script type="text/javascript" src="https://cdn.datatables.net/1.10.19/js/dataTables.jqueryui.min.js"></script>
	     -->
		<script type="text/javascript" src="./Tableros_files/dataTables.buttons.min.js"></script>
		<script type="text/javascript" src="./Tableros_files/buttons.flash.min.js"></script>
		<script type="text/javascript" src="./Tableros_files/jszip.min.js"></script>
		<script type="text/javascript" src="./Tableros_files/pdfmake.min.js"></script>
		<script type="text/javascript" src="./Tableros_files/vfs_fonts.js"></script>
		<script type="text/javascript" src="./Tableros_files/buttons.html5.min.js"></script>
		<script type="text/javascript" src="./Tableros_files/buttons.print.min.js"></script>
	     
	    <!-- 
	    <script src="script/highcharts.js"></script>
	     -->
	    <script src="./Tableros_files/data.js"></script>
	    <script src="./Tableros_files/drilldown.js"></script>
        

  <script src="http://code.highcharts.com/adapters/standalone-framework.js"></script>
        <script src="http://code.highcharts.com/highcharts.js"></script>
        <script src="http://code.highcharts.com/highcharts-3d.js"></script>
  <script src="http://code.highcharts.com/modules/exporting.js"></script>
	    
	    

	    
    <!--CORE JAVASCRIPT-->
    <script src="./Tableros_files/main.js"></script>
    <script>
    	(function (i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r;
            i[r] = i[r] || function () {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
            a = s.createElement(o),
            m = s.getElementsByTagName(o)[0];
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m)
        })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
        ga('create', 'UA-145464-12', 'auto');
        ga('send', 'pageview');

	</script>
	
	<script>
        
        $("#myModalTable").on("hide.bs.modal", function () {
            //$("#myModalTable tr").remove();
            $("#myModalTable tr>td").remove();
        });
    
        function setTD(el) {
            return "<td>"+el+"</td>";
        }
    
		function loadModalTable(idStatus, name, value) {
            var rows;
            var strJSon="";
            var objJSon;
            var strRows=""; 
            var dependency= $('#dependency option:selected').val();
            $.getJSON('./mock/project_detail.json', function(data) {
                try {
                    rows = jsonPath(data, "$.[?(@.dependency=='"+dependency+"' && @.id_estado_obra=='"+idStatus+"')]");
                    if(dependency == 14){ 
                        rows = jsonPath(data, "$.[?(@.id_estado_obra=='"+idStatus+"')]");
                    }
                     
                    for (var i=0;i<rows.length;i++) {
                        strRows="";
                        strRows+="<tr>";
                        strRows+=setTD(i+1);
                        strRows+=rows[i].project+"\n";                        
                        strRows+=setTD(rows[i].municipio);
                        strRows+=setTD(rows[i].categoria);
                        strRows+=setTD(rows[i].obra);
                        strRows+=setTD(rows[i].empresa);
                        strRows+=setTD(rows[i].numero_contrato);
                        strRows+=setTD(rows[i].monto_contrato);
                        strRows+=setTD(rows[i].inicio_obra_segun_contrato);
                        strRows+=setTD(rows[i].termino_obra_segun_contrato);
                        strRows+=setTD(rows[i].fecha_pago_anticipo);
                        strRows+=setTD(rows[i].monto_anticipo);
                        //strRows+=setTD(rows[i].fecha_convenio_ampliacion_obra);
                        strRows+=setTD(rows[i].convenio_ampliacion_economico);
                        strRows+=setTD(rows[i].monto_contrato_final);
                        strRows+=setTD(rows[i].total_pagado);
                        strRows+=setTD(rows[i].anticipo_pendiente_amortizar);
                        strRows+=setTD(rows[i].avance_financiero,);
                        strRows+=setTD(rows[i].avance_fisico_verificado_por_la_contraloria);
                        strRows+=setTD(rows[i].entregada_al_beneficiario);
                        strRows+=setTD(rows[i].fecha_de_verificacion_contraloria);
                        strRows+=setTD(rows[i].estatus_verificado_por_la_contraloria);                     
                        var rfimage = rows[i].registro_fotografico ? setTD(rows[i].registro_fotografico) : setTD("");                   
                        strRows+= rfimage;                   
                        //strRows+=setTD(rows[i].img_02);
                        strRows+="</tr>\n";
                        $("#myModalTable tbody").append(strRows);
                    }
                }catch(err){
                    alert("Error: "+err);
                }               
 
            });

			$('#myModalTable').modal('show');
		}
    
        function loadPlots(dependency) {
            var plots;
            var strJSon="[{}]";
            $.getJSON('./mock/plots.json', function(data) {
                try {
                    plots = jsonPath(data, "$.[?(@.id=='"+dependency+"')].plots[*]");
                    strJSon = JSON.stringify(plots);
                }catch(err){
                    alert("Error: "+err);
                }               
 
            });
            return strJSon;
        }
    
	</script>


         <script type="text/javascript">
             $(document).ready(function () {
    
                $.ajaxSetup({
                    async: false
                });
                 
				$('#sidebarCollapse').on('click', function () {
				    $('#sidebar').toggleClass('active');
				});

                var colorscharts = {
                    yellow : "#EEEE00"
                    ,green : "#009900"
                    ,red   : "#C70000"
                    ,gray  : "#999999"
                    ,orange: "#EE6600"
                    ,blue  : "#0000AA"
                }

			    $('#dependency').on('change', function() {
					var id=this.value;
					try {
					   var strJSon = "";
					   var data;
						if (id==0) {
							alert("Debes seleccionar una dependencia.");
						}else {
                            try {
                                strJSon = loadPlots(id-1);
                                data = JSON.parse(strJSon);
                            }catch(err){
                                alert("Error: "+err);
                            }
							const options = {
									chart: {
									  type: 'pie',
									  //plotBackgroundColor: null,
									  //plotBorderWidth: null,
									  //plotShadow: false,
                                      options3d: {
                                        enabled: true,
                                        alpha: 45,
                                        beta: 0
                                      }
									},
									title: {
									  text: 'GENL, 2019'
									},
									tooltip: {
									  pointFormat: '<b>{point.percentage:.1f} %</b>'
									},
									plotOptions: {
									  pie: {
									    allowPointSelect: true,
									    cursor: 'pointer',
                                        depth: 35,
							            point: {
							                events: {
							                    click: function () {
							                        loadModalTable(this.x, this.name, this.y);
                                                    console.log(this.x, this.name, this.y)
							                    }
							                }
							            },									    
									    dataLabels: {
									      enabled: true,
									      color: '#000000',
									      connectorColor: '#000000',
									      format: '<b>{point.name}</b>: {point.y:.0f}'
									    }
									  }
									},
									
									series: [{
									  data: []
									}]
								};
							const chart = Highcharts.chart('genl-pie-chart', options);
							chart.series[0].setData(data);
						}
					}catch(err){
						console.log("Error:"+err)
					}			    	
			    				    	  
			   	});
				
                
             }); //End On Ready

             
         </script>
         
         <script>
         // Meter aquí el evento para validar la forma antes del submit
		// Example starter JavaScript for disabling form submissions if there are invalid fields
		(function() {
		  'use strict';
		  window.addEventListener('load', function() {
		    // Fetch all the forms we want to apply custom Bootstrap validation styles to
		    var forms = document.getElementsByClassName('needs-validation');
		    // Loop over them and prevent submission
		    var validation = Array.prototype.filter.call(forms, function(form) {
		      form.addEventListener('submit', function(event) {
		        if (form.checkValidity() === false) {
		          event.preventDefault();
		          event.stopPropagation();
		        }
		        form.classList.add('was-validated');
		      }, false);
		    });
		  }, false);
		})();
		</script>
    

</body></html>
